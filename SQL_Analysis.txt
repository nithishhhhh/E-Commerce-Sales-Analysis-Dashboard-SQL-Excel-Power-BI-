# Creating Database:
create database ecommerce_sales ;
use ecommerce_sales ;

# Initial Data Analysis:

select * from `order`; -- View dataset
select count(*) from `order`; -- Count total rows
describe `order`; -- Check column structure

# Data Cleaning:
-- Rename Columns:
alter table `order` rename column `Order ID` TO order_id;
alter table `order` rename column `Order Date` TO order_date;
alter table `order` rename column `Customer Name` TO customer_name;
alter table `order` rename column`Product Name` TO product_name;
alter table `order` rename column `Payment Mode` TO payment_mode;
alter table `order` rename column  `Unit Price` TO unit_price;

-- Checking Null Values

select *
from `order`
where Sales is null 
   or Profit is null 
   or order_date is null;
   
   -- Remove Duplicates
select order_id, count(*)
from `order`
group by order_id
having count(*) > 1;

# KPI Analysis:
-- Total Revenue, Profit, Orders
select
    sum(Sales) as total_revenue,
    SUM(Profit) as total_profit,
count(order_id) as total_orders
from `order`;

# Regional Sales Analysis(BY GROUP):
select Region,
    sum(Sales) as total_sales,
    sum(Profit) as total_profit
from `order`
group by Region
order by total_sales desc;

# Time Based Analysis:
select 
    year(order_date) as year,
    month(order_date) as month,
    sum(Sales) as monthly_sales
from `order`
group by year, month
order by year, month;

# Category & Product Analysis:
select  Category,
    sum(Sales) as revenue,
    sum(Profit) as profit
from `order`
group by Category
order by revenue desc; -- Category Performance

select
    product_name,
    sum(Sales) as total_sales
from `order`
group by product_name
order by total_sales desc
limit 10; -- Top 10 Products

# Payment Mode Analysis:
select payment_mode,
    count(order_id) as total_orders,
    sum(Sales) as revenue
from  `order`
group by payment_mode
order by revenue desc;
